/*! tink-range-datepicker-angular v1.0.5 */
"use strict";!function(module){try{module=angular.module("tink.rangedatepicker")}catch(e){module=angular.module("tink.rangedatepicker",["tink.datehelper","tink.safeApply","tink.formathelper"])}module.directive("tinkDatepickerRange",["$q","$templateCache","$http","calView","$sce","$compile","dateCalculator","$window","safeApply",function($q,$templateCache,$http,calView,$sce,$compile,dateCalculator,$window,safeApply){return{restrict:"E",replace:!0,priority:0,require:["?^form"],templateUrl:"templates/tinkDatePickerRangeInputs.html",controller:function($scope,$attrs){$scope.dynamicName=$attrs.name,angular.isDefined($attrs.required)?$scope.requiredVal=!0:$scope.requiredVal=!1},scope:{firstDate:"=?",lastDate:"=?",minDate:"=?",maxDate:"=?",isDisabled:"=?"},compile:function(template,$attr){return(""===$attr.required||"required"===$attr.required)&&(template.find("input:first").attr("data-require",!0),template.find("input:last").attr("data-require",!0)),$attr.name&&(template.find("input:first").attr("name",$attr.name),template.find("input:last").attr("name",$attr.name)),{pre:function(){},post:function(scope,element,attrs,form){function buildView(){checkBefore($directive.viewDate,scope.minDate)?(scope.pane.prev=1,$directive.viewDate=new Date(scope.minDate)):scope.pane.prev=0,checkAfter($directive.viewDate,scope.maxDate)?(scope.pane.next=1,$directive.viewDate=new Date(scope.maxDate)):scope.pane.next=0,$directive.tbody.firstDateElem=element.find("tbody")[0],$directive.tbody.lastDateElem=element.find("tbody")[1];var htmlFirst=calView.createMonthDays($directive.viewDate,scope.firstDate,scope.lastDate,"prevMonth",scope.minDate,scope.maxDate);angular.element($directive.tbody.firstDateElem).replaceWith($compile(htmlFirst)(scope));var copyViewDate=new Date($directive.viewDate);copyViewDate.setDate(5),copyViewDate.setMonth(copyViewDate.getMonth()+1),scope.firstTitle=dateCalculator.format($directive.viewDate,"mmmm yyyy"),scope.lastTitle=dateCalculator.format(copyViewDate,"mmmm yyyy");var htmlLast=calView.createMonthDays(copyViewDate,scope.firstDate,scope.lastDate,"nextMonth",scope.minDate,scope.maxDate);angular.element($directive.tbody.lastDateElem).replaceWith($compile(htmlLast)(scope))}function checkBefore(date,before){if(!angular.isDate(date))return!1;if(!angular.isDate(before))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1),copyBefore=new Date(before.getFullYear(),before.getMonth(),1);return dateCalculator.dateBeforeOther(copyBefore,copyDate)?!0:!1}function checkAfter(date,after){if(!angular.isDate(date))return!1;if(!angular.isDate(after))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1),copyafter=new Date(after.getFullYear(),after.getMonth(),1);return dateCalculator.dateBeforeOther(copyDate,copyafter)?!0:!1}function nextMonth(){$directive.viewDate.setDate(1),$directive.viewDate.setMonth($directive.viewDate.getMonth()+1),setViewDate($directive.viewDate)}function prevMonth(){$directive.viewDate.setDate(1),$directive.viewDate.setMonth($directive.viewDate.getMonth()-1),setViewDate($directive.viewDate)}function setViewDate(viewDate){if(angular.isDate(viewDate)&&null!==viewDate)if(angular.isDate(viewDate)){var hulpDate=new Date(viewDate.getTime());hulpDate.setDate(1),hulpDate.setMonth(hulpDate.getMonth()-1),dateCalculator.isSameMonth(viewDate,$directive.viewDate)||dateCalculator.isSameMonth(hulpDate,$directive.viewDate)||($directive.viewDate=new Date(viewDate)),buildView()}else console.logerror("Wrong date")}function haalTemplateOp(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}function init(){isTouch&&(config.dateFormat="yyyy-mm-dd",angular.element($directive.focused.firstDateElem).prop("type","date"),angular.element($directive.focused.lastDateElem).prop("type","date")),scope.dateFormat=config.dateFormat,bindEvents()}function checkValidity(){null===scope.firstDate&&null!==scope.lastDate?(first.$setValidity("date-required",!1),firstEl.removeClass(noErrorClass)):null!==scope.firstDate&&null===scope.lastDate?(last.$setValidity("date-required",!1),lastEl.removeClass(noErrorClass)):null===scope.firstDate&&null===scope.lastDate?angular.isDefined(attrs.required)?(first.$setValidity("date-required",!1),last.$setValidity("date-required",!1),firstEl.removeClass(noErrorClass),lastEl.removeClass(noErrorClass)):(first.$setValidity("date-required",!0),last.$setValidity("date-required",!0),firstEl.addClass(noErrorClass),lastEl.addClass(noErrorClass)):null!==scope.firstDate&&null!==scope.lastDate&&(first.$setValidity("date-required",!0),last.$setValidity("date-required",!0),firstEl.addClass(noErrorClass),lastEl.addClass(noErrorClass)),first.$error.date&&(first.$setValidity("date-required",!0),firstEl.addClass(noErrorClass)),last.$error.date&&(last.$setValidity("date-required",!0),lastEl.addClass(noErrorClass))}function isDisabled(){return $($directive.focused.firstDateElem).scope().isDisabled&&$($directive.focused.lastDateElem).scope().isDisabled||scope.isDisabled}function $onMouseDown(evt){if(!isDisabled()&&(evt.target.isContentEditable?(evt.target.focus(),isTouch&&(evt.preventDefault(),evt.stopPropagation())):(evt.preventDefault(),evt.stopPropagation()),isTouch)){var targetEl=angular.element(evt.target);"button"!==targetEl[0].nodeName.toLowerCase()&&(targetEl=targetEl.parent()),targetEl.triggerHandler("click")}}function hide(){templateElem.css({display:"none"}),$directive.open=!1,$directive.focusedModel=null,safeApply(scope,function(){})}function bindEvents(){isTouch||element.bind("touchstart mousedown",$onMouseDown),angular.element($directive.focused.firstDateElem).bind("blur",hide),angular.element($directive.focused.lastDateElem).bind("blur",hide),angular.element($directive.focused.firstDateElem).bind("focus",function(){safeApply(scope,function(){isDisabled()||($directive.focusedModel="firstDateElem",show())})}),angular.element($directive.focused.lastDateElem).bind("focus",function(){safeApply(scope,function(){isDisabled()||($directive.focusedModel="lastDateElem",show())})})}function show(){$directive.open||(setViewDate(null!==$directive.focusedModel?"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:new Date:new Date),$directive.open=!0,templateElem.css({display:"block"}))}var $directive={open:!1,focused:{firstDateElem:element.find("div[tink-format-input] div:first"),lastDateElem:element.find("div[tink-format-input] div:last")},elem:{},calendar:{first:element.find("span.datepicker-icon:first"),last:element.find("span.datepicker-icon:last")},tbody:{firstDateElem:null,lastDateElem:null},focusedModel:null,selectedDates:{first:scope.firstDate,last:scope.lastDate},valid:{firstDateElem:!1,lastDateElem:!1},mouse:0,viewDate:new Date,hardCodeFocus:!1};attrs.name&&form[0]&&(scope.ctrlconst=form[0][attrs.name]),$directive.calendar.first.on("click",function(){isDisabled()||(isTouch?element.find("input[type=date]:first").click():$directive.open&&"firstDateElem"===$directive.focusedModel?hide():$directive.focused.firstDateElem.focus())}),$directive.calendar.last.on("click",function(){isDisabled()||(isTouch?element.find("input[type=date]:last").click():$directive.open&&"lastDateElem"===$directive.focusedModel?hide():$directive.focused.lastDateElem.focus())});var isDateSupported=function(){var i=document.createElement("input");return i.setAttribute("type","date"),"text"!==i.type},isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative&&isDateSupported(),dayLabels=["ma","di","wo","do","vr","za","zo"];scope.dayLabels=$sce.trustAsHtml("<th>"+dayLabels.join("</th><th>")+"</th>"),scope.$watch("firstDate",function(){null!==scope.firstDate?($directive.focusedModel="firstDateElem",scope.$select(scope.firstDate,null,!0),buildView()):checkValidity()}),scope.$watch("lastDate",function(){null!==scope.lastDate?($directive.focusedModel="lastDateElem",scope.$select(scope.lastDate,null,!0),buildView()):checkValidity()});var config={dateFormat:"dd/mm/yyyy"},fetchPromises={};scope.pane={prev:0,next:0};var templateElem,first=element.find("#input:first").controller("ngModel"),last=element.find("#input:last").controller("ngModel"),promise=haalTemplateOp("templates/tinkDatePickerRange.html");promise.then(function(template){angular.isObject(template)&&(template=template.data),templateElem=$compile(template),templateElem=templateElem(scope,function(){}),templateElem.css({position:"absolute",display:"none"}),element.append(templateElem),init()}),scope.$select=function(el,format,hardcoded){angular.isDefined(format)||(format="yyyy/mm/dd");var date;date=angular.isDate(el)?el:dateCalculator.getDate(el,format),null!==$directive.focusedModel&&("firstDateElem"===$directive.focusedModel?(scope.firstDate=date,angular.isDate(scope.lastDate)?dateCalculator.dateBeforeOther(scope.firstDate,scope.lastDate)&&(scope.lastDate=null,hardcoded||setTimeout(function(){$directive.focused.lastDateElem.focus()},1)):hardcoded||setTimeout(function(){$directive.focused.lastDateElem.focus()},1)):"lastDateElem"===$directive.focusedModel&&(scope.lastDate=date,angular.isDate(scope.firstDate)?dateCalculator.dateBeforeOther(scope.lastDate,scope.firstDate)||(scope.firstDate=null,hardcoded||setTimeout(function(){$directive.focused.firstDateElem.focus()},1)):hardcoded||setTimeout(function(){$directive.focused.firstDateElem.focus()},1))),checkValidity()};var noErrorClass="hide-error",firstEl=$(element.find(".faux-input")[0]),lastEl=$(element.find(".faux-input")[1]);scope.$selectPane=function(value){value?nextMonth():prevMonth()},element.on("mouseleave",function(){$directive.mouse=0}),element.on("mouseenter",function(){$directive.mouse=1})}}}}}])}(),angular.module("tink.rangedatepicker").run(["$templateCache",function($templateCache){$templateCache.put("templates/tinkDatePickerRange.html",'<div class=datepickerrange> <div class="pull-left datepickerrange-left"> <div class=datepickerrange-header-left> <div class=pull-left> <button tabindex=-1 type=button class="btn pull-left" ng-click=$selectPane(0)> <i class="fa fa-chevron-left"></i> </button> </div> <div class="text-center clearfix"> <label ng-bind=firstTitle></label> </div> </div> <div class=table-responsive> <table> <thead> <tr class=datepicker-days ng-bind-html=dayLabels> </tr> </thead> <tbody id=firstCal ng-bind-html=firstCal> </tbody> </table> </div> </div> <div class="pull-right datepickerrange-right"> <div class=datepickerrange-header-right> <div class=pull-right> <button tabindex=-1 type=button class="btn pull-left" ng-click=$selectPane(1)> <i class="fa fa-chevron-right"></i> </button> </div> <div class="text-center clearfix"> <label ng-bind=lastTitle></label> </div> </div> <div class=table-responsive> <table> <thead> <tr class=datepicker-days ng-bind-html=dayLabels></tr> </thead> <tbody id=secondCal ng-bind-html=secondCal> </tbody> </table> </div> </div> </div>'),$templateCache.put("templates/tinkDatePickerRangeInputs.html",'<div class="datepicker-input-fields row no-gutter"> <div class=col-sm-6> <input id=firstDateElem class=elem-one data-date data-format=00/00/0000 data-placeholder=dd/mm/jjjj tink-format-input ng-model=firstDate valid-name=first>\n<span class=datepicker-icon> <i class="fa fa-calendar"></i> </span> </div> <div class=col-sm-6> <input id=lastDateElem class=elem-two data-date data-format=00/00/0000 data-placeholder=dd/mm/jjjj tink-format-input ctrl-model=dynamicName valid-name=last ng-model=lastDate>\n<span class=datepicker-icon> <i class="fa fa-calendar"></i> </span> </div> </div>')}]);
//# sourceMappingURL=tink-range-datepicker-angular.min.map