/*! tink-range-datepicker-angular v1.0.5 */
"use strict";!function(module){try{module=angular.module("tink.rangedatepicker")}catch(e){module=angular.module("tink.rangedatepicker",["tink.datehelper","tink.safeApply","tink.formathelper"])}module.directive("tinkDatepickerRange",["$q","$templateCache","$http","calView","$sce","$compile","dateCalculator","$window","safeApply",function($q,$templateCache,$http,calView,$sce,$compile,dateCalculator,$window,safeApply){return{restrict:"E",replace:!1,priority:0,require:["?^form"],templateUrl:"templates/tinkDatePickerRangeInputs.html",controller:function($scope,$attrs){$scope.dynamicName=$attrs.name,angular.isDefined($attrs.required)?$scope.requiredVal=!0:$scope.requiredVal=!1},scope:{firstDate:"=?",lastDate:"=?",minDate:"=?",maxDate:"=?",isDisabled:"=?"},compile:function(template,$attr){return(""===$attr.required||"required"===$attr.required)&&(template.find("input:first").attr("data-require",!0),template.find("input:last").attr("data-require",!0)),$attr.name&&(template.find("input:first").attr("name",$attr.name),template.find("input:last").attr("name",$attr.name)),{pre:function(){},post:function(scope,element,attrs,form){function buildView(){checkBefore($directive.viewDate,scope.minDate)?(scope.pane.prev=1,$directive.viewDate=new Date(scope.minDate)):scope.pane.prev=0,checkAfter($directive.viewDate,scope.maxDate)?(scope.pane.next=1,$directive.viewDate=new Date(scope.maxDate)):scope.pane.next=0,$directive.tbody.firstDateElem=element.find("tbody")[0],$directive.tbody.lastDateElem=element.find("tbody")[1];var htmlFirst=calView.createMonthDays($directive.viewDate,$directive.selectedDates.first,$directive.selectedDates.last,"prevMonth",scope.minDate,scope.maxDate);angular.element($directive.tbody.firstDateElem).replaceWith($compile(htmlFirst)(scope));var copyViewDate=new Date($directive.viewDate);copyViewDate.setDate(5),copyViewDate.setMonth(copyViewDate.getMonth()+1),scope.firstTitle=dateCalculator.format($directive.viewDate,"mmmm yyyy"),scope.lastTitle=dateCalculator.format(copyViewDate,"mmmm yyyy");var htmlLast=calView.createMonthDays(copyViewDate,$directive.selectedDates.first,$directive.selectedDates.last,"nextMonth",scope.minDate,scope.maxDate);angular.element($directive.tbody.lastDateElem).replaceWith($compile(htmlLast)(scope))}function checkBefore(date,before){if(!angular.isDate(date))return!1;if(!angular.isDate(before))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1),copyBefore=new Date(before.getFullYear(),before.getMonth(),1);return dateCalculator.dateBeforeOther(copyBefore,copyDate)?!0:!1}function checkAfter(date,after){if(!angular.isDate(date))return!1;if(!angular.isDate(after))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1),copyafter=new Date(after.getFullYear(),after.getMonth(),1);return dateCalculator.dateBeforeOther(copyDate,copyafter)?!0:!1}function nextMonth(){$directive.viewDate.setDate(1),$directive.viewDate.setMonth($directive.viewDate.getMonth()+1),setViewDate($directive.viewDate)}function prevMonth(){$directive.viewDate.setDate(1),$directive.viewDate.setMonth($directive.viewDate.getMonth()-1),setViewDate($directive.viewDate)}function setViewDate(viewDate){if(angular.isDate(viewDate)&&null!==viewDate)if(angular.isDate(viewDate)){var hulpDate=new Date(viewDate.getTime());hulpDate.setDate(1),hulpDate.setMonth(hulpDate.getMonth()-1),dateCalculator.isSameMonth(viewDate,$directive.viewDate)||dateCalculator.isSameMonth(hulpDate,$directive.viewDate)||($directive.viewDate=new Date(viewDate)),buildView()}else console.logerror("Wrong date")}function haalTemplateOp(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}function init(){isTouch&&(config.dateFormat="yyyy-mm-dd",angular.element($directive.focused.firstDateElem).prop("type","date"),angular.element($directive.focused.lastDateElem).prop("type","date")),scope.dateFormat=config.dateFormat,bindEvents()}function setFirstDate(date){console.log(date),$(firstEl).scope()&&$(firstEl).scope().ctrl&&$(firstEl).scope().ctrl.setValue(dateCalculator.format(date,config.dateFormat))}function setLastDate(date){console.log(date),$(lastEl).scope()&&$(lastEl).scope().ctrl&&$(lastEl).scope().ctrl.setValue(dateCalculator.format(date,config.dateFormat))}function validFormat(date,format){var dateObject;if(angular.isDefined(date)&&null!==date){if("string"==typeof date){if(10!==date.length)return!1;if(!isTouch&&!/^(?:(?:31(\/)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/.test(date))return!1;dateObject=dateCalculator.getDate(date,format)}else{if(!angular.isDate(date))return"function"==typeof date?validFormat(date(),format):!1;dateObject=date}return dateObject&&"Invalid Date"!==dateObject.toString()}}function checkValidity(){null===scope.firstDate&&null!==scope.lastDate?(first.$setValidity("date-required",!1),firstEl.removeClass(noErrorClass)):null!==scope.firstDate&&null===scope.lastDate?(last.$setValidity("date-required",!1),lastEl.removeClass(noErrorClass)):null===scope.firstDate&&null===scope.lastDate?angular.isDefined(attrs.required)?(first.$setValidity("date-required",!1),last.$setValidity("date-required",!1),firstEl.removeClass(noErrorClass),lastEl.removeClass(noErrorClass)):(first.$setValidity("date-required",!0),last.$setValidity("date-required",!0),firstEl.addClass(noErrorClass),lastEl.addClass(noErrorClass)):null!==scope.firstDate&&null!==scope.lastDate&&(first.$setValidity("date-required",!0),last.$setValidity("date-required",!0),firstEl.addClass(noErrorClass),lastEl.addClass(noErrorClass)),first.$error.date&&(first.$setValidity("date-required",!0),firstEl.addClass(noErrorClass)),last.$error.date&&(last.$setValidity("date-required",!0),lastEl.addClass(noErrorClass))}function isDisabled(){return scope.isDisabled}function $onMouseDown(evt){if(!isDisabled()&&(evt.target.isContentEditable?(evt.target.focus(),isTouch&&(evt.preventDefault(),evt.stopPropagation())):(evt.preventDefault(),evt.stopPropagation()),isTouch)){var targetEl=angular.element(evt.target);"button"!==targetEl[0].nodeName.toLowerCase()&&(targetEl=targetEl.parent()),targetEl.triggerHandler("click")}}function hide(){templateElem.css({display:"none"}),$directive.open=!1,$directive.focusedModel=null,safeApply(scope,function(){var firstDate=$(firstEl).scope().ctrl.getValue();null!==firstDate&&void 0!==firstDate&&(scope.firstDate=dateCalculator.getDate(firstDate,$directive.dateFormat)),first.$ngBlur=!0,last.$ngBlur=!0;var lastDate=$(lastEl).scope().ctrl.getValue();null!==lastDate&&void 0!==lastDate&&(scope.lastDate=dateCalculator.getDate(lastDate,$directive.dateFormat))})}function bindEvents(){isTouch||element.bind("touchstart mousedown",$onMouseDown),element.bind("focus",function(){setTimeout(function(){$($directive.focused.firstDateElem).focus()},5)}),angular.element($directive.focused.firstDateElem).bind("blur",hide),angular.element($directive.focused.lastDateElem).bind("blur",hide),angular.element($directive.focused.firstDateElem).bind("focus",function(){safeApply(scope,function(){isDisabled()||($directive.focusedModel="firstDateElem",show())})}),angular.element($directive.focused.lastDateElem).bind("focus",function(){safeApply(scope,function(){isDisabled()||($directive.focusedModel="lastDateElem",show())})})}function show(){isTouch||$directive.open||(setViewDate(null!==$directive.focusedModel?"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:"firstDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.lastDate)?scope.lastDate:"lastDateElem"===$directive.focusedModel&&angular.isDate(scope.firstDate)?scope.firstDate:new Date:new Date),$directive.open=!0,templateElem.css({display:"block"}))}var $directive={open:!1,focused:{firstDateElem:element.find("div[tink-format-input] div:first"),lastDateElem:element.find("div[tink-format-input] div:last")},elem:{},calendar:{first:element.find("span.datepicker-icon:first"),last:element.find("span.datepicker-icon:last")},tbody:{firstDateElem:null,lastDateElem:null},focusedModel:null,selectedDates:{first:scope.firstDate,last:scope.lastDate},valid:{firstDateElem:!1,lastDateElem:!1},mouse:0,viewDate:new Date,hardCodeFocus:!1,dateFormat:"dd/mm/yyyy",values:{fist:null,last:null}};attrs.name&&form[0]&&(scope.ctrlconst=form[0][attrs.name]),$directive.calendar.first.on("click",function(){isDisabled()||(isTouch?element.find("input[type=date]:first").click():$directive.open&&"firstDateElem"===$directive.focusedModel?hide():$directive.focused.firstDateElem.focus())}),$directive.calendar.last.on("click",function(){isDisabled()||(isTouch?element.find("input[type=date]:last").click():$directive.open&&"lastDateElem"===$directive.focusedModel?hide():$directive.focused.lastDateElem.focus())});var isDateSupported=function(){var i=document.createElement("input");return i.setAttribute("type","date"),"text"!==i.type},isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative&&isDateSupported();isTouch&&($directive.focused.firstDateElem=element.find("input:first"),$directive.focused.lastDateElem=element.find("input:last"),$directive.dateFormat="yyyy-mm-dd");var dayLabels=["ma","di","wo","do","vr","za","zo"];scope.dayLabels=$sce.trustAsHtml("<th>"+dayLabels.join("</th><th>")+"</th>");var config={dateFormat:"dd/mm/yyyy"},fetchPromises={};scope.pane={prev:0,next:0};var templateElem,first=element.find("#input:first").controller("ngModel"),last=element.find("#input:last").controller("ngModel"),promise=haalTemplateOp("templates/tinkDatePickerRange.html");promise.then(function(template){angular.isObject(template)&&(template=template.data),templateElem=$compile(template),templateElem=templateElem(scope,function(){}),templateElem.css({position:"absolute",display:"none"}),element.append(templateElem),init()}),scope.$select=function(el,format,hardcoded){angular.isDefined(format)||(format="yyyy/mm/dd");var date;date=angular.isDate(el)?el:dateCalculator.getDate(el,format),"firstDateElem"===$directive.focusedModel?setFirstDate(date):setLastDate(date)},scope.$setTheDate=function(el,format,hardcoded,focus){angular.isDefined(format)||(format="yyyy/mm/dd");var date;date=angular.isDate(el)?el:dateCalculator.getDate(el,format),null!==$directive.focusedModel&&("firstDateElem"===$directive.focusedModel?($directive.selectedDates.first=date,angular.isDate($directive.selectedDates.last)?dateCalculator.dateBeforeOther($directive.selectedDates.first,$directive.selectedDates.last)&&($directive.selectedDates.last=null,scope.lastDate=null,hardcoded||setTimeout(function(){$directive.focused.lastDateElem.focus()},1)):hardcoded||setTimeout(function(){$directive.focused.lastDateElem.focus()},1)):"lastDateElem"===$directive.focusedModel&&($directive.selectedDates.last=date,angular.isDate($directive.selectedDates.first)?dateCalculator.dateBeforeOther($directive.selectedDates.last,$directive.selectedDates.first)||($directive.selectedDates.first=null,scope.firstDate=null,hardcoded||setTimeout(function(){$directive.focused.firstDateElem.focus()},1)):hardcoded||setTimeout(function(){$directive.focused.firstDateElem.focus()},1))),checkValidity()};var prevFirst,noErrorClass="hide-error",firstEl=$(element.find(".faux-input")[0]),lastEl=$(element.find(".faux-input")[1]);$directive.focused.firstDateElem.bind("valueChanged",function(e,val){safeApply(scope,function(){validFormat(val,config.dateFormat)?($directive.focusedModel="firstDateElem",scope.$setTheDate(dateCalculator.getDate(val,config.dateFormat),null,!0),setViewDate($directive.selectedDates.first),buildView()):($directive.selectedDates.first=null,setViewDate($directive.selectedDates.last?$directive.selectedDates.last:new Date),buildView()),firstEl&&prevFirst!==val&&firstEl.controller("ngModel").$setDirty(),$directive.values.first=val,prevFirst=val})});var prevLast;$directive.focused.lastDateElem.bind("valueChanged",function(e,val){safeApply(scope,function(){validFormat(val,config.dateFormat)?($directive.focusedModel="lastDateElem",scope.$setTheDate(dateCalculator.getDate(val,config.dateFormat),null,!0),setViewDate($directive.selectedDates.last),buildView()):($directive.selectedDates.last=null,setViewDate($directive.selectedDates.first?$directive.selectedDates.first:new Date),buildView()),lastEl&&prevLast!==val&&lastEl.controller("ngModel").$setDirty(),$directive.values.last=val,prevLast=val})}),scope.$selectPane=function(value){value?nextMonth():prevMonth()},element.on("mouseleave",function(){$directive.mouse=0}),element.on("mouseenter",function(){$directive.mouse=1})}}}}}])}(),angular.module("tink.rangedatepicker").run(["$templateCache",function($templateCache){$templateCache.put("templates/tinkDatePickerRange.html",'<div class=datepickerrange> <div class="pull-left datepickerrange-left"> <div class=datepickerrange-header-left> <div class=pull-left> <button tabindex=-1 type=button class="btn pull-left" ng-click=$selectPane(0)> <i class="fa fa-chevron-left"></i> </button> </div> <div class="text-center clearfix"> <label ng-bind=firstTitle></label> </div> </div> <div class=table-responsive> <table> <thead> <tr class=datepicker-days ng-bind-html=dayLabels> </tr> </thead> <tbody id=firstCal ng-bind-html=firstCal> </tbody> </table> </div> </div> <div class="pull-right datepickerrange-right"> <div class=datepickerrange-header-right> <div class=pull-right> <button tabindex=-1 type=button class="btn pull-left" ng-click=$selectPane(1)> <i class="fa fa-chevron-right"></i> </button> </div> <div class="text-center clearfix"> <label ng-bind=lastTitle></label> </div> </div> <div class=table-responsive> <table> <thead> <tr class=datepicker-days ng-bind-html=dayLabels></tr> </thead> <tbody id=secondCal ng-bind-html=secondCal> </tbody> </table> </div> </div> </div>'),$templateCache.put("templates/tinkDatePickerRangeInputs.html",'<div class="datepicker-input-fields row no-gutter"> <div class=col-sm-6> <input id=firstDateElem class=elem-one data-date data-format=00/00/0000 data-placeholder=dd/mm/jjjj tink-format-input ng-model=firstDate valid-name=first>\n<span class=datepicker-icon> <i class="fa fa-calendar"></i> </span> </div> <div class=col-sm-6> <input id=lastDateElem class=elem-two data-date data-format=00/00/0000 data-placeholder=dd/mm/jjjj tink-format-input ctrl-model=dynamicName valid-name=last ng-model=lastDate>\n<span class=datepicker-icon> <i class="fa fa-calendar"></i> </span> </div> </div>')}]);
//# sourceMappingURL=tink-range-datepicker-angular.min.map